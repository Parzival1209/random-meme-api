<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Random Meme</title>
  <script>
    async function go() {
      try {
        // Load memes.json file
        const response = await fetch("./memes.json");
        const list = await response.json();
        // Pick a random URL
        let url = list[Math.floor(Math.random() * list.length)];
        
        const img = new Image();
        img.style = "display: block;-webkit-user-select: none;margin: auto;background-color: hsl(0, 0%, 90%);transition: background-color 300ms;";

        // Check if the URL is a Reddit media link
        if (url.startsWith("https://www.reddit.com/media?url=")) {
          const params = new URLSearchParams(url.split('?')[1]);
          const redditUrl = params.get("url");
          if (redditUrl) url = decodeURIComponent(redditUrl);
        }

        // Check if it starts with http:// or https://
        if (url.startsWith("http://") || url.startsWith("https://")) {
          img.src = url;
        } else {
          img.src = "https://parzival1209.github.io/random-meme-api/" + url;
        }

        document.body.innerHTML = "";
        document.body.appendChild(img);
      } catch (e) {
        document.body.innerText = "Error loading meme list: " + e;
      }
    }

    go();
  </script>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      display: flex;
      text-color: #ffffff;
      align-items: center;
      background-color: #000;
      justify-content: center;
    }
    #imageContainer {
      color: #ffffff;
      overflow: auto;
      max-width: 100%;
      max-height: 100%;
      text-align: center;
    }
  </style>
</head>
<body>
</body>
</html>
